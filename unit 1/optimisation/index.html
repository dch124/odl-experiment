
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.4">
    
    
      
        <title>Optimisation - Deep Learning</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.75751829.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#optimisation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="Deep Learning" class="md-header-nav__button md-logo" aria-label="Deep Learning">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Deep Learning
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Optimisation
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Deep Learning" class="md-nav__button md-logo" aria-label="Deep Learning">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Deep Learning
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" checked>
    
    <label class="md-nav__link" for="nav-1">
      Unit 1
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Unit 1" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon"></span>
        Unit 1
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Optimisation
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Optimisation
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#optimisation" class="md-nav__link">
    Optimisation
  </a>
  
    <nav class="md-nav" aria-label="Optimisation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-problem" class="md-nav__link">
    The problem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gradient-descent" class="md-nav__link">
    Gradient descent
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../backpropagation/" class="md-nav__link">
      Backpropagation
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../pytorch/" class="md-nav__link">
      Pytorch
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Notes on MkDocs
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#optimisation" class="md-nav__link">
    Optimisation
  </a>
  
    <nav class="md-nav" aria-label="Optimisation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-problem" class="md-nav__link">
    The problem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gradient-descent" class="md-nav__link">
    Gradient descent
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Optimisation</h1>
                
                <h2 id="optimisation">Optimisation</h2>
<p>Optmisation is fundamental to machine learning. Here we look at the general problem of optimisation and later apply it to machine learning.</p>
<h3 id="the-problem">The problem</h3>
<p>In its simplest form, the optimsation problem can be expressed as follows. Given some function <span><span class="MathJax_Preview">f:\R\rightarrow\R</span><script type="math/tex">f:\R\rightarrow\R</script></span> we seek <span><span class="MathJax_Preview">x^*</span><script type="math/tex">x^*</script></span>, the value of <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> that gives the minimum output from the function:</p>
<div>
<div class="MathJax_Preview">x^*=\underset{x} {\operatorname{argmin}}f(x)</div>
<script type="math/tex; mode=display">x^*=\underset{x} {\operatorname{argmin}}f(x)</script>
</div>
<p><img alt="Finding the minimum of a function in 1-D" src="../minimise1D.png" /></p>
<p>For functions with n-dimensional input and a scalar output <span><span class="MathJax_Preview">f:\R^n\rightarrow\R</span><script type="math/tex">f:\R^n\rightarrow\R</script></span>  we seek <span><span class="MathJax_Preview">\myvec{x}^*</span><script type="math/tex">\myvec{x}^*</script></span>, the value of <span><span class="MathJax_Preview">\myvec{x}</span><script type="math/tex">\myvec{x}</script></span> that gives the minimum output from the function:</p>
<div>
<div class="MathJax_Preview">\myvec{x}^*=\underset{\myvec{x\in\R^n}} {\operatorname{argmin}}f(\myvec{x})</div>
<script type="math/tex; mode=display">\myvec{x}^*=\underset{\myvec{x\in\R^n}} {\operatorname{argmin}}f(\myvec{x})</script>
</div>
<h3 id="gradient-descent">Gradient descent</h3>
<p>Gradient descent is a general approach for finding the minimum of a function. The idea is to start with some random <span><span class="MathJax_Preview">\myvec{x}</span><script type="math/tex">\myvec{x}</script></span> and make repeated small step-changes to <span><span class="MathJax_Preview">\myvec{x}</span><script type="math/tex">\myvec{x}</script></span> in the direction of steepest descent of the output <span><span class="MathJax_Preview">f(\myvec{x})</span><script type="math/tex">f(\myvec{x})</script></span>.  The following diagram illustrates this idea for <span><span class="MathJax_Preview">n=2</span><script type="math/tex">n=2</script></span>.</p>
<p><img alt="image of 2-D surface and rolling down hill" src="../rosenbrock-nag.png" />
<img alt="test" src="../graph.svg" /></p>
<p>To do this we need to be able to work out the gradient of the surface at a given point.  This amounts to seeing how the output changes with infinitesimally small changes in each of the components of <span><span class="MathJax_Preview">\myvec{x}</span><script type="math/tex">\myvec{x}</script></span> - the so-called <em>gradient vector</em>: </p>
<div>
<div class="MathJax_Preview">\nabla f(\myvec{x}) = \begin{bmatrix} \frac {\partial f}{\partial x_1} (\myvec{x})\\ \vdots \\ \frac {\partial f}{\partial x_n}  (\myvec{x}) \end{bmatrix}</div>
<script type="math/tex; mode=display">\nabla f(\myvec{x}) = \begin{bmatrix} \frac {\partial f}{\partial x_1} (\myvec{x})\\ \vdots \\ \frac {\partial f}{\partial x_n}  (\myvec{x}) \end{bmatrix}</script>
</div>
<p>For example, in 2-D suppose</p>
<div>
<div class="MathJax_Preview">f(x,y)=3x^2+xy</div>
<script type="math/tex; mode=display">f(x,y)=3x^2+xy</script>
</div>
<p>The gradient vector is then given by</p>
<div>
<div class="MathJax_Preview">\nabla f(x,y)=\begin{bmatrix} 6x \\ x \end {bmatrix}</div>
<script type="math/tex; mode=display">\nabla f(x,y)=\begin{bmatrix} 6x \\ x \end {bmatrix}</script>
</div>
<p>Thus, the gradient myvector at <span><span class="MathJax_Preview">(3,4)</span><script type="math/tex">(3,4)</script></span> is <span><span class="MathJax_Preview">\begin{bmatrix} 18 \\ 3 \end {bmatrix}</span><script type="math/tex">\begin{bmatrix} 18 \\ 3 \end {bmatrix}</script></span>. This vector is in the direction of the steepest slope and has magnitude equal to the slope. This is the direction in which we should move to get closer to the summit (maximum value). To reach the minimum we move in the opposite direction.
Thus, we make a small step from <span><span class="MathJax_Preview">\myvec{x}</span><script type="math/tex">\myvec{x}</script></span> to a new point <span><span class="MathJax_Preview">\myvec{x'}</span><script type="math/tex">\myvec{x'}</script></span> defined as follows:</p>
<div>
<div class="MathJax_Preview">\myvec{x'}=\myvec{x}-\eta \nabla f(\myvec{x})</div>
<script type="math/tex; mode=display">\myvec{x'}=\myvec{x}-\eta \nabla f(\myvec{x})</script>
</div>
<p><span><span class="MathJax_Preview">\eta</span><script type="math/tex">\eta</script></span> simply scales the step size and is generally a small number (e.g. <span><span class="MathJax_Preview">\eta=0.002</span><script type="math/tex">\eta=0.002</script></span>)
Notice that the displacement is subtracted so that we move downhill.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
        
          <a href="../backpropagation/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Backpropagation
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>